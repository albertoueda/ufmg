#!/usr/bin/perl
#
# WIRE
# This script generates tables to be used in LaTeX.
#
# Usage: run in one of the output directories generated by
#        wire-info-analysis --sitelink-analysis
#

use IO::File	();

my	$dir	= `dirname $0`;	chomp $dir;
require "$dir/wire-report.lib";

use strict;
use warnings;

WIRE::init( "sitelink" );

########################################################################
#
# Generate the latex tables (documents)
# 
########################################################################

WIRE::latex_table( "stats", nosort=>1, nopercent=>1 );
WIRE::latex_table( "graph_component_sizes", nosort=>1,
	parse_row => sub {
		my @line    = @_;
		$line[0] =~ s/^COMPONENT_//;
		return @line;
	});
WIRE::latex_table( "scc_sizes", nosort=>1 );

WIRE::gnuplot(
	datafile        => "scc_sizes.csv",
	out             => "scc_sizes",
	using           => '($1):($3) "%lf,%lf,%lf"',
	fit				=> 1,
	fitmin			=> WIRE::conf( 'analysis/sitelink/scc_sizes/fitmin' ),
	fitmax			=> WIRE::conf( 'analysis/sitelink/scc_sizes/fitmax' ),
	logscale		=> 'xy',
	range			=> WIRE::conf( 'analysis/sitelink/scc_sizes/range' ),
	xlabel          => 'Strongly connected component size',
	ylabel          => 'Fraction of strongly connected components',
	with            => 'points pt 6'
);

WIRE::latex_report();
